<nav class="navbar pt-5">
  <div class="container d-flex align-items-end flex-column">
    <a class="navbar-brand" href="#">
      <i class="fa-regular fa-bell"></i>
    </a>

    <%= link_to destroy_user_session_path, data: {turbo_method: :delete} do %>
      <i class="fa-solid fa-power-off" style="color:#E96479"></i>
    <% end %>

    <%= link_to new_split_path do %>
      <i class="fa-solid fa-rotate-right" style="color:#E96479"></i>
    <% end %>
  </div>
</nav>






<div class="welcome-message" style="text-align: center";>
  <h1>Hello <%= current_user.username %></h1>
</div>

<div class="container mt-5" style="text-align: center";>
  <div class="row">
  <div class="col-sm-6 mb-3 mb-sm-0">
    <div class="card splits-summary-card">
      <div class="card-body">
        <h5 class="card-title">Owed: </h5>

        <p class="card-text">SGD $ <%= format('%.2f',current_user.owed_summary(current_user)/100.00) %></p>
        <%= link_to "View Splits", splits_path, class:"create-button" %>

      </div>
    </div>
  </div>
  <div class="col-sm-6">
    <div class="card splits-summary-card">
      <div class="card-body">
        <h5 class="card-title">Owe: </h5>
      <p class="card-text">SGD $<%= format('%.2f',current_user.owe_summary(current_user)/100.00) %></p>
        <%= link_to "View Splits", splits_path, class:"create-button" %>
      </div>
    </div>
  </div>
</div>
</div>

<div class="container mt-5">
  <h4>Transactions</h4>
  <div class="accordion accordion-flush" id="accordionFlushExample">
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">

            <%= (Split.all.select { |split| split.bills.count.positive?}).last.name %>

        </button>
      </h2>
      <div id="flush-collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
        <div class="accordion-body">
          <% (Split.all.select { |split| split.bills.count.positive?}).last.bills.each do |bill| %>
            <div>
              <i class="fa-solid fa-receipt"></i>
              <%= bill.merchant %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwo" aria-expanded="false" aria-controls="flush-collapseTwo">
          <%= (Split.all.select { |split| split.bills.count.positive?})[-2].name %>
        </button>
      </h2>
      <div id="flush-collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
        <div class="accordion-body">
          <% (Split.all.select { |split| split.bills.count.positive?})[-2].bills.each do |bill| %>
            <div>
              <i class="fa-solid fa-receipt"></i>
              <%= bill.merchant %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseThree" aria-expanded="false" aria-controls="flush-collapseThree">

          <%= (Split.all.select { |split| split.bills.count.positive?})[-3].name %>
        </button>
      </h2>
      <div id="flush-collapseThree" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
        <div class="accordion-body">
          <% (Split.all.select { |split| split.bills.count.positive?})[-3].bills.each do |bill| %>
            <div>
              <i class="fa-solid fa-receipt"></i>
              <%= bill.merchant %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  <div class="my-3 mx-4 text-end">
    <%= link_to "See More", splits_path, class:"text-decoration-none pink-color-text" %>
  </div>
  <div class="my-5">
  </div>
</div>
